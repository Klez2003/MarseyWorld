{% extends "settings/settings.html" %}
{% block pagetitle %}Advanced Settings{% endblock %}
{% block content %}
	<div class="row settings-page" id="settings-page-advanced">
		<div class="col col-lg-8">
			<div class="settings">
				<section id="site-settings-device-specific-section" class="settings-section-section"> {# note: not using the thing from common just because of how much stuff there is in here #}
					<h5>Device-specific Settings</h5>
					<div class="settings-section rounded">
						{% if IS_MUSICAL_EVENT() %}
							{{common.toggle_section('Event Music', 'event_music_switch', 'event_music', v.event_music, 'Toggle event music.', false)}}
						{% endif %}

						<div id="poor_mode_switch_toggle" class="d-lg-flex border-bottom">
							<div class="title w-lg-25">
								<label for="poor">Poor Mode</label>
							</div>
							<div class="body w-lg-100 pt-1 pt-lg-3">
								<div class="custom-control custom-switch">
									<input autocomplete="off" type="checkbox" class="custom-control-input setting_switch" data-nonce="{{g.nonce}}" id="poor" name="poor"{% if session.get('poor') %} checked{% endif %}>
									<label class="custom-control-label" for="poor"></label>
								</div>
								<span class="text-small text-muted">Makes the site faster for low-end devices:</span>
								<ul>
									<li><small>Disables the effects of cosmetic awards.</small></li>
									<li><small>Makes emoji search only start when you press Enter.</small></li>
									<li><small>Hides signatures.</small></li>
									<li><small>Limits frontpage size to 25 posts.</small></li>
								</ul>
							</div>
						</div>

						{% if FEATURES['NSFW_MARKING'] %}
							{{common.toggle_section('NSFW Warnings', 'nsfw_warnings', 'nsfw_warnings', v.nsfw_warnings, "Show a warning when viewing NSFW posts, collapse NSFW comments, and hide NSFW emojis in search.", false)}}
						{% endif %}

						{{common.toggle_section('Cursor Marsey', 'cursormarseyswitch', 'cursormarsey', v.cursormarsey, 'Have a cute
						marsey accompany you during your journey on the site.', false)}}
					</div>
				</section>


				<section id="site-settings-sort-time-filter-section" class="settings-section-section">
					<h5>Sorting and Filtering</h5>
					<div class="settings-section rounded">
						<div id="frontsize_select" class="d-lg-flex border-bottom">
							<div class="title w-lg-25">
								<label for="frontsize">Frontpage Size</label>
							</div>
							<div class="body w-lg-100">
								<p>Change how many posts appear on every page.</p>
								<div class="input-group">
									<select autocomplete="off" id='frontsize' class="form-control setting_select" data-nonce="{{g.nonce}}" form="profile-settings" name="frontsize">
									{% for entry in PAGE_SIZES %}
										<option value="{{entry}}"{{' selected' if v.frontsize == entry}}>{{entry}}</option>
									{% endfor %}
									</select>
								</div>
							</div>
						</div>
						<div id="defaultsortingcomments_select" class="d-lg-flex border-bottom">
							<div class="title w-lg-25">
								<label for="defaultsortingcomments">Default Sorting for Comments</label>
							</div>
							<div class="body w-lg-100">
								<p>Change the default sorting for comments.</p>
								<div class="input-group">
									<select autocomplete="off" id='defaultsortingcomments' class="form-control setting_select" data-nonce="{{g.nonce}}" form="profile-settings" name="defaultsortingcomments">
									{% for entry in COMMENT_SORTS.keys() - ['saves'] %}
										<option value="{{entry}}"{{' selected' if v.defaultsortingcomments == entry}}>{{entry}}</option>
									{% endfor %}
								</select>
								</div>
							</div>
						</div>
						<div id="defaultsorting_select" class="d-lg-flex border-bottom">
							<div class="title w-lg-25">
								<label for="defaultsorting">Default Sorting for Posts</label>
							</div>
							<div class="body w-lg-100">
								<p>Change the default sorting for posts.</p>
								<div class="input-group">
									<select autocomplete="off" id='defaultsorting' class="form-control setting_select" data-nonce="{{g.nonce}}" form="profile-settings" name="defaultsorting">
									{% for entry in POST_SORTS.keys() %}
										<option value="{{entry}}"{{' selected' if v.defaultsorting == entry}}>{{entry}}</option>
									{% endfor %}
								</select>
								</div>
							</div>
						</div>
						<div id="defaulttime_select" class="d-lg-flex border-bottom">
							<div class="title w-lg-25">
								<label for="defaulttime">Default Time Filter for Posts</label>
							</div>
							<div class="body w-lg-100">
								<p>Change the default time filter for posts.</p>
								<div class="input-group">
									<select autocomplete="off" id='defaulttime' class="form-control setting_select" data-nonce="{{g.nonce}}" form="profile-settings" name="defaulttime">
									{% for entry in TIME_FILTERS.keys() %}
										<option value="{{entry}}"{{' selected' if v.defaulttime == entry}}>{{entry}}</option>
									{% endfor %}
								</select>
								</div>
							</div>
						</div>
					</div>
				</section>
				<section id="site-settings-tab-behavior-section" class="settings-section-section">
					<h5>Tab Behavior</h5>
					<div class="settings-section rounded">
						{{common.toggle_section("Open Internal Links in New Tabs", "newtab", "newtab", v.newtab, "Enable if you would like to automatically open links to other pages on the site in new tabs.", false)}}
						{{common.toggle_section("Open External Links in New Tabs", "newtabexternal", "newtabexternal", v.newtabexternal, "Enable if you would like to automatically open links to other sites in new tabs.", false)}}
					</div>
				</section>

				{% if SITE_NAME != 'WPD' %}
					<section id="site-settings-external-services-section" class="settings-section-section">
						<h5>External Links</h5>
						<div class="settings-section rounded">
							{{common.toggle_section("Use imgsed for Instagram Links", "imgsed", "imgsed", v.imgsed, "Enable if you would like to automatically convert instagram.com links to imgsed.com links.", false)}}

							{{common.line_text_section('twitter', '/settings/twitter', 'twitter', 'Twitter Domain', v.twitter, 'Limit of 50 characters', 'Change the domain you would like to view twitter posts in.', 'Save', false, 5, 50, '[A-Za-z0-9.-]+', false, 'Change the domain you would like to view twitter posts in.')}}

							<div class="d-lg-flex border-bottom">
								<div class="title w-lg-25">
									<label for="reddit">Reddit Domain</label>
								</div>
								<div class="body w-lg-100">
									<p>Change the domain you would like to view reddit posts in.</p>
									<div class="input-group">
										<select autocomplete="off" id='reddit' class="form-control setting_select" data-nonce="{{g.nonce}}" form="profile-settings" name="reddit">
										{% for entry in ['old.reddit.com', 'new.reddit.com', 'sh.reddit.com', 'reddit.com', 'undelete.pullpush.io'] %}
											<option value="{{entry}}" {{'selected' if v.reddit == entry}}>{{entry}}</option>
										{% endfor %}
									</select>
									</div>
								</div>
							</div>
							{{common.toggle_section("Sort Reddit Links by Controversial", "controversial", "controversial", v.controversial, "Enable if you would like to automatically sort reddit.com links by controversial.", false)}}
						</div>
					</section>
				{% endif %}

				<section id="site-settings-content-filters" class="settings-section-section">
					<h5>Content Filters</h5>
					<div class="settings-section rounded">
						{{common.toggle_section('User Signatures', 'show_sigs', 'show_sigs', v.show_sigs, 'Show user signatures.', false)}}
						{% if SITE_NAME == 'WPD' %}
							{{common.toggle_section('Hide Posts Voted On', 'hidevotedon', 'hidevotedon', v.hidevotedon, 'Enable if you would like to automatically hide posts you have voted on from your frontpage.', false)}}
							{{common.toggle_section('Hide Posts with Child Warning', 'hide_cw', 'hide_cw', v.hide_cw, 'Enable if you would like to automatically hide posts that have a child warning.', false)}}
						{% endif %}
						<div id="custom-filter-section" class="d-lg-flex border-bottom">
							<div class="title w-lg-25">
								<label for="custom-filter">Custom Filters</label>
							</div>
							<div class="body w-lg-100">
								<form id="custom-filter" action="/settings/filters" method="post" data-nonce="{{g.nonce}}" data-onsubmit="sendFormXHR(this)">
									<input hidden name="formkey" value="{{v|formkey}}" class="notranslate" translate="no">
									<small>Hides matching posts from the frontpage and collapses matching comments.</small>
									<textarea autocomplete="off" class="form-control rounded my-2" placeholder="Add your own custom content filters."
									rows="3" name="filters" form="custom-filter" maxlength="1000">{% if v.custom_filter_list %}{{v.custom_filter_list}}{% endif %}</textarea>
									<small>Use a new line for each entry. Limit of 1000 characters.</small>
									<div class="d-flex">
										<input autocomplete="off" class="btn btn-primary ml-auto" type="submit" value="Save Changes">
									</div>
								</form>
							</div>
						</div>
					</div>
				</section>

				<section id="site-settings-notifications" class="settings-section-section">
					<h5>Notifications</h5>
					<div class="settings-section rounded">
						{% if v.offsite_mentions != None %}
							{{common.toggle_section('Site Mention Notifications', 'offsite_mentions', 'offsite_mentions', v.offsite_mentions, 'Get a notification when people on other sites talk about us.', false)}}
						{% endif %}
						{{common.toggle_section('Effortpost Notifications', 'effortpost_notifs', 'effortpost_notifs', v.effortpost_notifs, 'Get a notification when a new effortpost is made.', false)}}
						{% if SITE_NAME != 'WPD' %}
							{{common.toggle_section('Hole Creation and Death Notifications', 'hole_creation_notifs', 'hole_creation_notifs', v.hole_creation_notifs, 'Get a notification when a hole is made or deleted.', false)}}
						{% endif %}
						{{common.toggle_section('Ping Group Creation Notifications', 'group_creation_notifs', 'group_creation_notifs', v.group_creation_notifs, 'Get a notification when a new ping group is made.', false)}}
						<div id="keyword-notifs-section" class="d-lg-flex border-bottom">
							<div class="title w-lg-25">
								<label for="keyword-notifs">Keyword Notifications</label>
							</div>
							<div class="body w-lg-100">
								<form id="keyword-notifs" action="/settings/keyword_notifs" method="post" data-nonce="{{g.nonce}}" data-onsubmit="sendFormXHR(this)">
									<input hidden name="formkey" value="{{v|formkey}}" class="notranslate" translate="no">
									<small>Notifies you when specific words or phrases are mentioned.</small>
									<textarea autocomplete="off" class="form-control rounded my-2" placeholder="Add your own keyword notifications."
									rows="3" name="keyword_notifs" form="keyword-notifs" maxlength="1000">{% if v.keyword_notifs %}{{v.keyword_notifs}}{% endif %}</textarea>
									<small>Use a new line for each entry. Limit of 1000 characters.</small>
									<p class="text-small">Will stop taking effect if you reach 100 unread red notifications.</p>
									<div class="d-flex">
										<input autocomplete="off" class="btn btn-primary ml-auto" type="submit" value="Save Changes">
									</div>
								</form>
							</div>
						</div>						
					</div>
				</section>

				<section id="site-settings-snappy-quotes" class="settings-section-section">
					<h5>Custom Snappy Quotes</h5>
					<div class="settings-section rounded">
						<div id="snappy-quotes-section" class="d-lg-flex border-bottom">
							<div class="title w-lg-25">
								<label for="snappy-quotes">Custom Snappy Quotes</label>
							</div>
							<div class="body w-lg-100">
								<form id="snappy-quotes" action="/settings/snappy_quotes" method="post" data-nonce="{{g.nonce}}" data-onsubmit="sendFormXHR(this)">
									<input hidden name="formkey" value="{{v|formkey}}" class="notranslate" translate="no">
									<small>Enter things you would like <a href="/id/{{SNAPPY_ID}}" rel="nofollow"><img src="/pp/{{SNAPPY_ID}}">@Snappy</a> to reply to your posts with.</small>
									<textarea autocomplete="off" class="form-control rounded my-2" placeholder="Add your own custom Snappy quotes."
									rows="3" name="snappy_quotes" form="snappy-quotes" maxlength="{{USER_SNAPPY_QUOTES_LENGTH}}">{% if v.snappy_quotes %}{{v.snappy_quotes}}{% endif %}</textarea>
									<small>Separate quotes with <code>[para]</code>. Limit of {{USER_SNAPPY_QUOTES_LENGTH}} characters</small>
									<div class="d-flex">
										<input autocomplete="off" class="btn btn-primary ml-auto" type="submit" value="Save Changes">
									</div>
								</form>
							</div>
						</div>						
					</div>
				</section>

				<section id="site-settings-sort-time-filter-section" class="settings-section-section">
					<h5>RSS Feed</h5>
					<p class="text-small text-muted">Subscribe to the {{SITE_NAME}} RSS feed.</p>
					<div class="settings-section rounded">
						<div class="d-lg-flex">
							<div class="body w-lg-100">
								<input autocomplete="off" type="text" readonly="" class="form-control copy-link" value="{{SITE_FULL}}/rss/hot/all" data-clipboard-text="{{SITE_FULL}}/rss/hot/all">
								<div class="text-small text-muted mt-3">You can change the feed by replacing "hot" with whatever sorting you want and "all" with whatever time filter you want.</div>
							</div>
						</div>
					</div>
				</section>
			</div>
		</div>
	</div>
{% endblock %}
